<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shiiou | Tchat Direct</title>
    <meta name="description" content="Shiiou | 3 Packs Graphiques sont désormais disponible gratuitement">
    <meta name="author" content="Shiiou">
    <meta name="keywords" content="fivem, gtarp, pack, pack graphique, shiiou">
    <link rel="canonical" href="https://shiiou.github.io/">
    <meta name="robots" content="all">
  
    <link rel="icon" type="image/png" sizes="512x512" href="favicon-512x512.png">
    <!-- Inclure Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <style>
        /* Styles pour la sidebar */
        .sidebar {
            height: 100vh;
            /* Couleur de fond sombre similaire à X */
            background-color: #000;
            color: white;
            padding: 10px;
        }
        
        /* Styles pour le contenu principal */
        .main-content {
            /* Couleur de fond légèrement plus claire que la sidebar */
            background-color: #000000;
            color: white;
            padding: 10px;
        }
        
        /* Styles pour la zone de chat */
        .chat {
            height: 80vh;
            overflow-y: auto;
        }
        
        /* Styles pour la prévisualisation de l'image */
        #imagePreview {
            max-width: 100px;
            max-height: 100px;
            margin-top: 10px;
            display: none;
        }

        /* Styles pour les boutons */
        .btn-primary {
            /* Couleur d'accent bleu de X */
            background-color: #1DA1F2;
            border-color: #1DA1F2;
        }
        .btn-primary:hover {
            background-color: #0c85d0;
            border-color: #0c85d0;
        }
        .btn-secondary {
            /* Couleur secondaire grise */
            background-color: #536471;
            border-color: #536471;
        }
        .btn-secondary:hover {
            background-color: #40505a;
            border-color: #40505a;
        }

        /* Styles pour les éléments de liste */
        .list-group-item {
            background-color: #15202B;
            color: white;
        }
        .list-group-item:hover {
            background-color: #ffffff;
        }

        /* Styles pour les cartes de messages */
        .card {
            background-color: #192734;
            border: none;
        }
        .card-title {
            color: #1DA1F2;
        }
        .card-text {
            color: #D9D9D9;
        }

        /* Media query pour tablettes */
        @media (max-width: 768px) {
            .row {
                flex-direction: column;
            }
            .sidebar, .main-content {
                width: 100% !important;
            }
            .sidebar {
                height: auto;
            }
            .main-content .chat {
                height: 60vh;
            }
        }

        /* Media query pour smartphones */
        @media (max-width: 576px) {
            .row {
                flex-direction: column;
            }
            .sidebar, .main-content {
                width: 100% !important;
            }
            .sidebar {
                height: auto;
            }
            .main-content .chat {
                height: 50vh;
            }
            #imagePreview {
                max-width: 80px;
                max-height: 80px;
            }
        }
    </style>
</head>
<body class="d-flex flex-column h-100">
    <div class="container-fluid h-100">
        <div class="row h-100">
            <!-- Sidebar -->
            <div class="col-3 sidebar">
                <!-- Titre de la sidebar modifié en Shiiou -->
                <h2 id="siteTitle">Shiiou</h2>
                <!-- Champ de recherche modifié pour la recherche de mots clés -->
                <div class="input-group mb-3">
                    <input type="text" class="form-control" id="searchInput" placeholder="Mots-clés" onkeyup="searchMessages()">
                </div>
                <!-- Liste des catégories modifiée -->
                <div class="list-group">
                    <a href="https://shiiou.webflow.io/" class="list-group-item list-group-item-action">Pack Graphique</a>
                    <a href="https://www.tiktok.com/@shiiouuu_" class="list-group-item list-group-item-action">Tiktok</a>
                </div>
            </div>
            <!-- Main Content (Chat) -->
            <div class="col-9 main-content">
                <!-- Zone de chat -->
                <div class="chat" id="chatMessages">
                    <!-- Les messages seront ajoutés ici dynamiquement -->
                </div>
                <!-- Formulaire d'envoi de message avec ajout d'image, déplacé en bas -->
                <form class="input-group mb-3" action="#" method="post" enctype="multipart/form-data">
                    <input type="text" class="form-control" name="message" placeholder="Envoyer un message">
                    <!-- Bouton pour ajouter une image -->
                    <input type="file" class="form-control" name="image" accept="image/*" id="imageUpload" style="display:none;" onchange="previewImage(event)">
                    <button class="btn btn-secondary" type="button" onclick="document.getElementById('imageUpload').click();">Ajouter une image</button>
                    <button class="btn btn-primary" type="submit">Envoyer</button>
                </form>
                <!-- Prévisualisation de l'image -->
                <img id="imagePreview" src="#" alt="Votre image">
            </div>
        </div>
    </div>
    <!-- Inclure Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <script>
        // Variable pour stocker le pseudo de l'utilisateur
        let userPseudo = '';

        // Fonction pour demander le pseudo à l'utilisateur
        function askForPseudo() {
            userPseudo = localStorage.getItem('userPseudo') || prompt('Veuillez entrer votre pseudo :', 'Utilisateur');
            if (userPseudo === null || userPseudo.trim() === '') {
                // Si l'utilisateur annule ou ne fournit pas de pseudo, on utilise un pseudo par défaut
                userPseudo = 'Utilisateur';
            }
            localStorage.setItem('userPseudo', userPseudo);
            // On met à jour le titre du site avec le pseudo
            document.getElementById('siteTitle').textContent = userPseudo + '@Shiiou';
        }

        // Fonction pour sauvegarder un message dans le localStorage
        function saveMessage(message, imageDataURL) {
            let messages = JSON.parse(localStorage.getItem('messages') || '[]');
            messages.push({ user: userPseudo, message: message, image: imageDataURL });
            localStorage.setItem('messages', JSON.stringify(messages));
        }

        // Fonction pour charger les messages depuis le localStorage
        function loadMessages() {
            let messages = JSON.parse(localStorage.getItem('messages') || '[]');
            messages.forEach(msg => {
                displayMessage(msg.user, msg.message, msg.image);
            });
        }

        // Écouteur d'événement pour le chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            askForPseudo();
            loadMessages();
        });

        // Fonction pour gérer l'envoi de message et l'affichage dans le chat
        document.querySelector('form').addEventListener('submit', function(event) {
            event.preventDefault(); // Empêcher le rechargement de la page
            var messageInput = this.querySelector('input[name="message"]');
            var message = messageInput.value;
            var imageInput = this.querySelector('input[name="image"]');
            var image = imageInput.files[0];
            
            if (message.trim() !== '' || image) {
                let imageDataURL = '';
                if (image) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        imageDataURL = e.target.result;
                        saveMessage(message, imageDataURL);
                        displayMessage(userPseudo, message, imageDataURL);
                        // Cacher la prévisualisation après l'envoi
                        document.getElementById('imagePreview').style.display = 'none';
                    };
                    reader.readAsDataURL(image);
                } else {
                    saveMessage(message, '');
                    displayMessage(userPseudo, message, '');
                }
                // Effacer le champ après l'envoi
                messageInput.value = '';
                imageInput.value = '';
            }
        });

        // Fonction pour afficher le message dans le chat
        function displayMessage(user, message, imageDataURL) {
            let messageElement = document.createElement('div');
            messageElement.className = 'card mb-3';
            
            let messageBody = document.createElement('div');
            messageBody.className = 'card-body';
            
            let messageTitle = document.createElement('h5');
            messageTitle.className = 'card-title';
            messageTitle.textContent = user;
            
            messageBody.appendChild(messageTitle);
            
            if (message.trim() !== '') {
                let messageText = document.createElement('p');
                messageText.className = 'card-text';
                messageText.textContent = message;
                messageBody.appendChild(messageText);
            }
            
            if (imageDataURL) {
                let messageImage = document.createElement('img');
                messageImage.src = imageDataURL;
                messageImage.className = 'img-fluid mb-2';
                messageBody.insertBefore(messageImage, messageBody.firstChild);
            }
            
            messageElement.appendChild(messageBody);
            document.getElementById('chatMessages').appendChild(messageElement);
        }

        // Fonction pour prévisualiser l'image
        function previewImage(event) {
            var input = event.target;
            var reader = new FileReader();
            reader.onload = function(){
                var dataURL = reader.result;
                var output = document.getElementById('imagePreview');
                output.src = dataURL;
                output.style.display = 'block';
            };
            reader.readAsDataURL(input.files[0]);
        }

        // Fonction pour rechercher les messages
        function searchMessages() {
            var searchTerm = document.getElementById('searchInput').value.toLowerCase();
            var messages = document.getElementById('chatMessages').children;
            
            for (var i = 0; i < messages.length; i++) {
                var messageText = messages[i].querySelector('.card-text');
                var messageImage = messages[i].querySelector('img');
                
                if (messageText && messageText.textContent.toLowerCase().indexOf(searchTerm) > -1 || 
                    (messageImage && messageImage.alt.toLowerCase().indexOf(searchTerm) > -1)) {
                    messages[i].style.display = ""; // Afficher le message si le terme de recherche est trouvé
                } else {
                    messages[i].style.display = "none"; // Cacher le message si le terme de recherche n'est pas trouvé
                }
            }
        }
    </script>
</body>
</html>